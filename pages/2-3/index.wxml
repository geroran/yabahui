<view class="container" bindtap="handleTap">
  <!-- 背景层 -->
  <view class="bg-layer">
    <image class="bg-image" src="/pages/2-3/images/1未开启的大门.webp" mode="aspectFill"></image>
    <view class="bg-overlay"></view>
  </view>

  <!-- 内容层 -->
  <view class="content-layer" wx:if="{{gameState === 'opening'}}">
    <view class="text-container">
      <text class="opening-text line-1">大哑巴今日入户送吉</text>
      <text class="opening-text line-2">请随他完成驱邪与纳福之礼</text>
      
      <view class="divider"></view>
      
      <text class="opening-text line-3">仪式开始</text>
      <text class="opening-text line-4">愿你的脚步带来山风般的祝福</text>
    </view>

    <view class="start-prompt">
      <text class="prompt-text">点击屏幕开启仪式</text>
      <view class="prompt-icon">👆</view>
    </view>
  </view>

  <!-- 解谜层 (拼图) -->
  <view class="puzzle-layer" wx:if="{{gameState === 'puzzle'}}">
    <view class="puzzle-header">
      <text class="puzzle-title">入门解谜</text>
      <text class="puzzle-subtitle">点击交换拼块，还原大门</text>
    </view>

    <view class="puzzle-container">
      <view 
        class="puzzle-piece {{selectedPiece === index ? 'selected' : ''}} {{item.isCorrect ? 'correct' : ''}}" 
        wx:for="{{puzzlePieces}}" 
        wx:key="id"
        style="left: {{item.x * 200}}rpx; top: {{item.y * 200}}rpx; background-position: -{{item.origX * 200}}rpx -{{item.origY * 200}}rpx;"
        bindtap="handlePieceTap"
        data-index="{{index}}"
      ></view>
    </view>

    <!-- 帮助按钮 -->
    <view class="help-btn" bindtap="autoSolvePuzzle">
      <text>有困难，请大哑巴帮忙开门</text>
    </view>

    <!-- 成功提示 -->
    <view class="success-overlay" wx:if="{{isPuzzleSolved}}">
      <text class="success-text">门已应声而开</text>
      <text class="success-subtext">欢迎步入这户人家</text>
    </view>
  </view>
</view>
